<!DOCTYPE html>
<html>
  <head>
    <title>HunterXHunter</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='Home.css') }}"
    />
  </head>
  <body>
    <details class="details">
      <summary>More Info!</summary>
      <p>Welcome to our website! This project allows you to:</p>

      <ul>
        <li>
          Take live stream videos from a URL or directly from a camera feed
        </li>
        <li>Draw a virtual line to specify your gate</li>
        <li>
          Enjoy the power of AI to count the people in and out of your gate
        </li>
      </ul>

      <p>Here's how to get started:</p>

      <ol>
        <li>Choose the port of your camera or URL</li>
        <li>Save the name of your gate</li>
        <li>
          Press "Get Started" to see your live feed and draw the virtual line
        </li>
      </ol>

      <p>
        Experience the convenience and efficiency of our system in managing
        people flow at your gate!
      </p>
      <p>**Note: Enter Your Data In English**</p>
    </details>
    <div class="login-box">
      <h2>Welcome</h2>
      <p class="paragrgh">Count People In&Out</p>
      <form>
        <div id="dropdownContainer" class="dropdownContainer"></div>

        <div class="user-box">
          <input type="text" id="gateNameInput" name="" required="" />
          <label>Gate Name</label>
        </div>

        <div class="navigation-button">
          <a href="{{ url_for('second_page', gate_name=gateNameInput) }}" id="countingButton">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            Counting
          </a>
          <a href="{{ url_for('third_page', gate_name=gateNameInput) }}" id="crowdingButton">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            Crowding
          </a>
        </div>
      </form>
    </div>
    <script>
      // Get the input element by its id
      var gateNameInput = document.getElementById("gateNameInput");

      // Get the dropdown element by its tag name
      var dropdown = document.querySelector("select");

      // Get the "Get Started" button by its tag name
      var countingButton = document.getElementById("countingButton");
      var crowdingButton = document.getElementById("crowdingButton");

      // Event listener for the "Get Started" button click
      countingButton.addEventListener("click", function (event) {
        event.preventDefault();
        sendData('counting');
      });

      crowdingButton.addEventListener("click", function (event) {
        event.preventDefault();
        sendData('crowding');
      });

      function sendData(mode) {
        // Retrieve the input value
        var inputValue = gateNameInput.value;

        // Retrieve the selected value from the dropdown
        var selectedDropdownValue =
          dropdown.options[dropdown.selectedIndex].text;

        // Create an object with the data to send
        var dataToSend = {
          input: inputValue,
          dropdown: selectedDropdownValue,
          mode: mode,
        };

        // Use the Fetch API to send data to a Flask endpoint
        fetch("http://127.0.0.1:5000", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(dataToSend),
        })
          .then((response) => response.json())
          .then((data) => {
            console.log("Server response:", data);
            if (mode === 'counting') {
              window.location.href = "second_page";
            } else if (mode === 'crowding') {
              window.location.href = "third_page";
            }
          })
          .catch((error) => {
            console.error("Error sending data to server:", error);
          });
      }
    </script>
    <script>
      // JavaScript code to create a dropdown dynamically
      var dropdownContainer = document.getElementById("dropdownContainer");

      // Create select element
      var dropdown = document.createElement("select");

      var option1 = document.createElement("option");
      option1.text = "0";
      dropdown.add(option1);

      var option2 = document.createElement("option");
      option2.text = "1";
      dropdown.add(option2);

      var option3 = document.createElement("option");
      option3.text = "2";
      dropdown.add(option3);

      var option4 = document.createElement("option");
      option4.text = "3";
      dropdown.add(option4);

      var option5 = document.createElement("option");
      option5.text = "URL";
      dropdown.add(option5);

      dropdownContainer.appendChild(dropdown);

      dropdown.addEventListener("change", function () {
        var selectedOption = dropdown.options[dropdown.selectedIndex].text;
        if (selectedOption === "URL") {
          var textField = document.createElement("input");
          textField.setAttribute("type", "text");
          textField.setAttribute("placeholder", "Enter URL");
          dropdownContainer.appendChild(textField);
        } else {
          var existingTextField = dropdownContainer.querySelector("input[type='text']");
          if (existingTextField) {
            existingTextField.remove();
          }
        }
      });
    </script>
  </body>
</html>
